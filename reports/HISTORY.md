# 의약품 동의어 사전 구축 프로젝트 개발 보고서

## 📋 프로젝트 개요

**프로젝트명**: 요양급여 업무 지원용 의약품 동의어 사전 구축 시스템  
**개발 기간**: 2025년 9월 1일  
**목적**: 심사과 간호사와 의료진의 의약품 검색 업무 효율성 개선을 위한 OpenSearch용 동의어 사전 구축

## 🎯 개발 배경

요양급여 업무를 담당하는 심사과 간호사와 의료진들이 경험하는 문제들:

1. **검색 용어의 다양성**: 같은 의약품을 성분명(영문/한글), 제품명, 브랜드명으로 다양하게 검색하는 상황
2. **데이터 분산**: 의약품 정보가 여러 파일에 분산되어 통합적인 검색이 어려운 환경
3. **수작업의 부담**: 49,000개 이상의 의약품 데이터를 수작업으로 관리하는 현실적 한계
4. **검색 누락**: 동일 성분의 다른 제품명들이 연결되지 않아 발생하는 검색 누락

## 📊 원천 데이터

### 입력 데이터 (3개 파일)
1. **적용약가 파일** (Excel, 49,557건)
   - 제품명, 업체명, 주성분코드 등 포함
   - 건강보험 적용 의약품의 핵심 정보
   
2. **ATC 코드 매핑** (CSV, 21,953건)  
   - 국제 ATC 코드와 한국 의약품의 매핑 테이블
   - 성분명 영문/한글 정보 포함
   
3. **주성분 마스터** (CSV, 892건)
   - 건강보험심사평가원 공식 주성분 데이터
   - 한글 성분명의 표준 레퍼런스

## 🔧 기술적 구현

### 1. 데이터 정제 및 전처리
```python
def fix_brackets_and_repetition(text: str) -> str:
    # 불완전한 괄호 패턴 수정
    # 반복되는 문자열 제거  
    # 용량/수량 정보 정리
```

**처리한 주요 문제:**
- 불완전한 괄호 오류 처리 시도 (예: `aldesleukin(rhIL-2,` → `aldesleukin`)
- 중복 문자열 제거 작업 (예: `selumetinib hydrogen sulfate )selumetinib...`)
- 회사명 형식 통일 노력 (예: `갈더마코리아(주` → `(주) 갈더마코리아`)

### 2. 성분별 그룹핑 구현
```python
def normalize_ingredient_for_grouping(ingredient: str) -> str:
    # 영문명 우선 정규화
    # 대소문자, 공백 표준화
    # 동일 성분의 다양한 표기법 통합
```

**적용한 알고리즘:**
- 주성분코드가 아닌 **성분명 기준**으로 그룹핑하여 중복 제거 시도
- 영문명을 우선 키로 사용하고, 한글명을 보조 키로 활용
- 동일 성분의 다양한 브랜드명들을 하나로 통합하는 접근

### 3. 한글 성분명 매핑
- 기존 영문 위주 데이터에 한글 성분명 892개 매핑 추가
- 정규 표현식을 이용한 한글 포함 여부 판별
- 영문-한글 성분명 변형 패턴 생성 (공백 제거, 하이픈 처리 등)

## 📁 출력 결과 (5개 파일)

### 1. 고유명사 사전 (3,169개)
의약품 관련 모든 고유명사 (성분명, 회사명 등)
```
(주) 삼성제약
abacavir sulfate  
클로랄 하이드레이트
```

### 2. 주성분코드 매핑 (2,389개)
코드를 대표 명칭으로 변환하는 단방향 매핑
```
130830ASY => 클로랄하이드레이트, chloral hydrate
420101ATB => abacavir sulfate, 지아겐정, 키벡사정
```

### 3. 성분 한글/영문 (2,389개) 
검색 최적화를 위한 성분명 변형 패턴
```
chloral hydrate, 클로랄 하이드레이트, 클로랄하이드레이트
CA-125의 정량 검사, CA 125의 정량 검사, CA-125의정량검사  
```

### 4. 검색용 유의어 사전 (2,389개)
제품명과 성분명을 함께 포함한 통합 검색 사전
```
지아겐정, 키벡사정, 트리멕정, abacavir sulfate
```

### 5. 주성분별 약품 그룹 (1,409개)
동일 성분의 모든 브랜드 제품들을 그룹핑
```
amino acids: 가네파솔주, 건푸렉스주, 게라민주, [127개 제품명...]
```

## 📈 처리 결과

### 정량적 결과
- **데이터 처리**: 99.3% (49,557건 중 49,200건 처리 완료)
- **그룹핑**: 동일 성분 여러 제품을 1,409개 그룹으로 통합
- **키워드 생성**: 단일 성분당 평균 15개 검색 키워드 생성

### 기대 효과
- **검색 개선**: 성분명/제품명 다방향 검색을 통한 누락 위험 감소
- **효율성**: 수작업 매핑 작업의 자동화 시도
- **품질 개선**: 괄호 오류, 중복 항목 등 데이터 품질 문제 처리

## 🔍 기술적 특징

### 1. 텍스트 처리 시도
- 정규표현식을 활용한 괄호 오류 처리
- 다국어(한글/영문) 텍스트 인코딩 처리 (CP949, UTF-8)
- 반복 패턴 감지 및 정리 노력

### 2. 데이터 구조 활용
- `defaultdict`를 활용한 메모리 효율적 그룹핑
- 집합(set) 자료구조로 중복 제거
- 대용량 데이터(49K+ 레코드) 처리

### 3. 업무 환경 고려
- 요양급여 업무 담당자의 검색 패턴 고려
- OpenSearch/Elasticsearch 동의어 규칙 호환 형식
- 의료진이 사용하는 다양한 용어법 반영 시도

## 🚀 개선 방향

1. **실시간 업데이트**: 신규 의약품 출시 시 자동 사전 갱신 기능
2. **사용 패턴 분석**: 실제 검색 로그 분석을 통한 동의어 규칙 개선  
3. **다국어 지원**: 영문/한글 외 추가 언어 지원 확대
4. **API 개발**: 다른 의료 시스템 연동을 위한 API 인터페이스 구현

---

*본 프로젝트는 Python, pandas, 정규표현식을 활용하여 의료 데이터 처리 및 자연어 처리 기술을 의료 현장의 실무에 적용해 본 사례입니다.*